{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useLocation,useNavigate}from'react-router-dom';// Configuração do Mercado Pago - PUBLIC KEY CONFIGURADA\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const MERCADO_PAGO_PUBLIC_KEY='TEST-63319c0b-3d7e-4fd4-9a08-b97ef21fc423';export default function Pagamento(){var _location$state,_location$state2,_location$state3,_location$state4;const location=useLocation();const navigate=useNavigate();const[loading,setLoading]=useState(false);const[error,setError]=useState('');const[pixData,setPixData]=useState(null);const[cardFormData,setCardFormData]=useState({cardNumber:'',cardholderName:'',expirationMonth:'',expirationYear:'',securityCode:'',identificationType:'CPF',identificationNumber:'',email:''});// Pegar dados do state ou da URL como fallback\nconst valor=((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.valor)||parseFloat(new URLSearchParams(location.search).get('valor')||'0');const metodo=((_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.metodo)||new URLSearchParams(location.search).get('metodo')||'pix';const festa=(_location$state3=location.state)===null||_location$state3===void 0?void 0:_location$state3.festa;const quantidades=(_location$state4=location.state)===null||_location$state4===void 0?void 0:_location$state4.quantidades;// Debug para verificar os dados recebidos\nuseEffect(()=>{console.log('Dados recebidos no pagamento:',{valor:valor,metodo:metodo,festa:festa,state:location.state});},[valor,metodo,festa,location.state]);useEffect(()=>{// Carregar SDK do Mercado Pago\nconst script=document.createElement('script');script.src='https://sdk.mercadopago.com/js/v2';script.async=true;document.body.appendChild(script);script.onload=()=>{// Inicializar Mercado Pago quando o script carregar\nif(window.MercadoPago){window.mp=new window.MercadoPago(MERCADO_PAGO_PUBLIC_KEY);console.log('Mercado Pago SDK carregado com sucesso!');}};return()=>{if(document.body.contains(script)){document.body.removeChild(script);}};},[]);// Função para criar pagamento PIX\nconst createPixPayment=async()=>{setLoading(true);setError('');try{const response=await fetch('/api/create-pix-payment',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({transaction_amount:valor,description:`Ingresso para ${(festa===null||festa===void 0?void 0:festa.nome)||'festa'}`,payment_method_id:'pix',payer:{email:cardFormData.email||'cliente@email.com'},metadata:{festa_id:festa===null||festa===void 0?void 0:festa.id,festa_nome:festa===null||festa===void 0?void 0:festa.nome,quantidades:quantidades}})});const data=await response.json();if(data.point_of_interaction){setPixData({qr_code:data.point_of_interaction.transaction_data.qr_code,qr_code_base64:data.point_of_interaction.transaction_data.qr_code_base64,payment_id:data.id});// 🆕 SIMULAÇÃO: Após 15 segundos, simular pagamento aprovado (APENAS PARA TESTES)\n// Em produção, isso será feito via webhook do Mercado Pago\nsetTimeout(()=>{console.log('Simulando pagamento PIX aprovado...');navigate('/dados',{state:{paymentId:data.id,status:'approved',valor:valor,festa:festa}});},15000);// 15 segundos para dar tempo de testar\n}else{setError(data.error||'Erro ao gerar QR Code. Tente novamente.');}}catch(err){setError('Erro ao gerar pagamento PIX. Verifique se o servidor está rodando.');console.error('Erro:',err);}finally{setLoading(false);}};// 🔧 FUNÇÃO CORRIGIDA: Processar pagamento com cartão\nconst processCardPayment=async()=>{setLoading(true);setError('');try{// Validar campos antes de enviar\nif(!validateCardForm()){setError('Por favor, preencha todos os campos corretamente.');setLoading(false);return;}// Criar token do cartão usando SDK do Mercado Pago\nif(window.mp){try{// Dados do cartão para criar o token\nconst cardData={cardNumber:cardFormData.cardNumber.replace(/\\s/g,''),cardholderName:cardFormData.cardholderName,cardExpirationMonth:String(cardFormData.expirationMonth).padStart(2,'0'),cardExpirationYear:`20${cardFormData.expirationYear}`,securityCode:cardFormData.securityCode,identificationType:cardFormData.identificationType,identificationNumber:cardFormData.identificationNumber.replace(/\\D/g,'')};console.log('🔧 Dados do cartão para token:',cardData);const token=await window.mp.createCardToken(cardData);console.log('🎯 Token criado:',token);if(!token||!token.id){throw new Error('Falha ao criar token do cartão');}// 🔧 CORREÇÃO: Payload limpo para o backend\nconst paymentPayload={token:token.id,transaction_amount:valor,description:`Ingresso para ${(festa===null||festa===void 0?void 0:festa.nome)||'festa'}`,installments:1,// 🎯 REMOVIDO: payment_method_id fixo - deixa o MP detectar automaticamente\n// 🎯 REMOVIDO: issuer_id - pode causar conflitos\npayer:{email:cardFormData.email,identification:{type:cardFormData.identificationType,number:cardFormData.identificationNumber.replace(/\\D/g,'')}},metadata:{festa_id:festa===null||festa===void 0?void 0:festa.id,festa_nome:festa===null||festa===void 0?void 0:festa.nome,quantidades:quantidades}};console.log('🚀 Enviando para backend:',paymentPayload);// Enviar token para o backend\nconst response=await fetch('/api/process-card-payment',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(paymentPayload)});const data=await response.json();console.log('🎯 Resposta do backend:',data);if(data.status==='approved'){console.log('✅ Pagamento aprovado! Método detectado:',data.payment_method_id);// Redirecionar para /dados\nnavigate('/dados',{state:{paymentId:data.id,status:data.status,valor:valor,festa:festa,paymentMethod:data.payment_method_id// Incluir método detectado\n}});}else{setError(`Pagamento ${data.status}. ${data.message||data.status_detail||'Tente novamente.'}`);}}catch(tokenError){console.error('❌ Erro ao criar token:',tokenError);setError('Erro ao processar dados do cartão. Verifique as informações.');}}else{// Fallback se o SDK não carregar\nconsole.error('❌ SDK do Mercado Pago não carregado');setError('Erro ao carregar sistema de pagamento. Recarregue a página.');}}catch(err){setError('Erro ao processar pagamento. Verifique se o servidor está rodando.');console.error('❌ Erro:',err);}finally{setLoading(false);}};// Validar formulário do cartão\nconst validateCardForm=()=>{return cardFormData.email&&cardFormData.cardNumber.length>=16&&cardFormData.cardholderName&&cardFormData.expirationMonth&&cardFormData.expirationYear&&cardFormData.securityCode.length>=3&&cardFormData.identificationNumber.length>=11;};// Formatar número do cartão\nconst formatCardNumber=value=>{const v=value.replace(/\\s+/g,'').replace(/[^0-9]/gi,'');const matches=v.match(/\\d{4,16}/g);const match=matches&&matches[0]||'';const parts=[];for(let i=0,len=match.length;i<len;i+=4){parts.push(match.substring(i,i+4));}if(parts.length){return parts.join(' ');}else{return value;}};// Renderizar formulário de PIX\nconst renderPixForm=()=>/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:!pixData?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-20 bg-teal-500/20 rounded-full flex items-center justify-center mx-auto mb-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-4xl\",children:\"\\uD83D\\uDCF1\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold mb-2\",children:\"Pagamento via PIX\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"R\\xE1pido, seguro e sem taxas adicionais\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-700/50 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-300 mb-2\",children:\"Valor a pagar:\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-teal-400\",children:[\"R$ \",valor.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-2\",children:\"E-mail (para receber o comprovante)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:cardFormData.email,onChange:e=>setCardFormData({...cardFormData,email:e.target.value}),className:\"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\",placeholder:\"seu@email.com\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:createPixPayment,disabled:loading||valor===0,className:\"w-full py-4 bg-teal-500 text-white font-medium rounded-lg transition-all hover:bg-teal-400 disabled:opacity-50 disabled:cursor-not-allowed\",children:loading?'Gerando PIX...':'Gerar código PIX'})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold mb-2\",children:\"PIX Gerado!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"Escaneie o QR Code ou copie o c\\xF3digo\"})]}),pixData.qr_code_base64&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-4 rounded-lg mx-auto w-fit\",children:/*#__PURE__*/_jsx(\"img\",{src:`data:image/png;base64,${pixData.qr_code_base64}`,alt:\"QR Code PIX\",className:\"w-64 h-64\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm text-gray-400\",children:\"PIX Copia e Cola:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-700/50 rounded-lg p-4 break-all\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-mono text-gray-300\",children:pixData.qr_code})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigator.clipboard.writeText(pixData.qr_code),className:\"w-full py-3 bg-gray-700 text-white font-medium rounded-lg transition-all hover:bg-gray-600\",children:\"Copiar c\\xF3digo PIX\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-gray-600 pt-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400 text-center mb-3\",children:\"\\u26A0\\uFE0F Modo de teste:\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/dados',{state:{paymentId:pixData.payment_id,status:'approved',valor:valor,festa:festa}}),className:\"w-full py-3 bg-green-600 text-white font-medium rounded-lg transition-all hover:bg-green-500\",children:\"\\uD83E\\uDDEA Simular Pagamento Aprovado\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-sm text-gray-400\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Ap\\xF3s o pagamento, voc\\xEA ser\\xE1 redirecionado automaticamente\"})})]})});// Renderizar formulário de cartão\nconst renderCardForm=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-20 bg-teal-500/20 rounded-full flex items-center justify-center mx-auto mb-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-4xl\",children:\"\\uD83D\\uDCB3\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold mb-2\",children:\"Pagamento com Cart\\xE3o\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"Cr\\xE9dito ou d\\xE9bito \\u2022 Aceita Visa, Master, Amex\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-700/50 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-300 mb-2\",children:\"Valor a pagar:\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-teal-400\",children:[\"R$ \",valor.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-2\",children:\"E-mail\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",required:true,value:cardFormData.email,onChange:e=>setCardFormData({...cardFormData,email:e.target.value}),className:\"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\",placeholder:\"seu@email.com\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-2\",children:\"N\\xFAmero do Cart\\xE3o\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,maxLength:\"19\",value:cardFormData.cardNumber,onChange:e=>setCardFormData({...cardFormData,cardNumber:formatCardNumber(e.target.value)}),className:\"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\",placeholder:\"0000 0000 0000 0000\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400 mt-1\",children:\"Aceita Visa, Mastercard, American Express\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-2\",children:\"Nome no Cart\\xE3o\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,value:cardFormData.cardholderName,onChange:e=>setCardFormData({...cardFormData,cardholderName:e.target.value.toUpperCase()}),className:\"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\",placeholder:\"NOME COMPLETO\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-2\",children:\"Validade\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,maxLength:\"2\",value:cardFormData.expirationMonth,onChange:e=>setCardFormData({...cardFormData,expirationMonth:e.target.value.replace(/\\D/g,'')}),className:\"px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\",placeholder:\"MM\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,maxLength:\"2\",value:cardFormData.expirationYear,onChange:e=>setCardFormData({...cardFormData,expirationYear:e.target.value.replace(/\\D/g,'')}),className:\"px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\",placeholder:\"AA\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-2\",children:\"CVV\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,maxLength:\"4\",value:cardFormData.securityCode,onChange:e=>setCardFormData({...cardFormData,securityCode:e.target.value.replace(/\\D/g,'')}),className:\"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\",placeholder:\"123\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-2\",children:\"CPF do Titular\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,maxLength:\"14\",value:cardFormData.identificationNumber,onChange:e=>{let value=e.target.value.replace(/\\D/g,'');if(value.length<=11){value=value.replace(/(\\d{3})(\\d{3})(\\d{3})(\\d{2})/,'$1.$2.$3-$4');}setCardFormData({...cardFormData,identificationNumber:value});},className:\"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\",placeholder:\"000.000.000-00\"})]})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-500/20 border border-red-500/50 rounded-lg p-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-red-400 text-sm\",children:error})}),/*#__PURE__*/_jsx(\"button\",{onClick:processCardPayment,disabled:loading||valor===0,className:\"w-full py-4 bg-teal-500 text-white font-medium rounded-lg transition-all hover:bg-teal-400 disabled:opacity-50 disabled:cursor-not-allowed\",children:loading?'Processando...':'Finalizar Pagamento'}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-gray-600 pt-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400 text-center mb-3\",children:\"\\u26A0\\uFE0F Modo de teste:\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/dados',{state:{paymentId:'MP-TEST-'+Date.now(),status:'approved',valor:valor,festa:festa}}),className:\"w-full py-3 bg-green-600 text-white font-medium rounded-lg transition-all hover:bg-green-500\",children:\"\\uD83E\\uDDEA Simular Pagamento Aprovado\"})]})]});// Se o valor for 0, mostrar erro\nif(valor===0){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-900 text-white p-4 md:p-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-md mx-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-800 rounded-xl shadow-lg border border-gray-700 p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-red-400 mb-4\",children:\"Erro no pagamento\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-300 mb-6\",children:\"Nenhum valor foi informado para o pagamento.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(-1),className:\"w-full py-3 bg-teal-500 text-white font-medium rounded-lg transition-all hover:bg-teal-400\",children:\"Voltar ao checkout\"})]})})});}return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-900 text-white p-4 md:p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-md mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-8\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>navigate(-1),className:\"text-gray-400 hover:text-white transition-colors flex items-center group\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5 mr-2 transform group-hover:-translate-x-1 transition-transform\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M10 19l-7-7m0 0l7-7m-7 7h18\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"Voltar\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-teal-500 text-white px-3 py-1 rounded-full\",children:\"Pagamento Seguro\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold mb-1\",children:\"Pagamento\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"Complete sua compra de forma segura\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-800 rounded-xl shadow-lg border border-gray-700 overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:metodo==='pix'?renderPixForm():renderCardForm()})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 flex items-center justify-center space-x-4 text-xs text-gray-500\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Pagamento processado por\"}),/*#__PURE__*/_jsx(\"img\",{src:\"https://http2.mlstatic.com/frontend-assets/mp-web-navigation/ui-navigation/5.21.22/mercadopago/logo__large@2x.png\",alt:\"Mercado Pago\",className:\"h-6 filter brightness-75\"})]})]})});}","map":{"version":3,"names":["React","useState","useEffect","useLocation","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MERCADO_PAGO_PUBLIC_KEY","Pagamento","_location$state","_location$state2","_location$state3","_location$state4","location","navigate","loading","setLoading","error","setError","pixData","setPixData","cardFormData","setCardFormData","cardNumber","cardholderName","expirationMonth","expirationYear","securityCode","identificationType","identificationNumber","email","valor","state","parseFloat","URLSearchParams","search","get","metodo","festa","quantidades","console","log","script","document","createElement","src","async","body","appendChild","onload","window","MercadoPago","mp","contains","removeChild","createPixPayment","response","fetch","method","headers","JSON","stringify","transaction_amount","description","nome","payment_method_id","payer","metadata","festa_id","id","festa_nome","data","json","point_of_interaction","qr_code","transaction_data","qr_code_base64","payment_id","setTimeout","paymentId","status","err","processCardPayment","validateCardForm","cardData","replace","cardExpirationMonth","String","padStart","cardExpirationYear","token","createCardToken","Error","paymentPayload","installments","identification","type","number","paymentMethod","message","status_detail","tokenError","length","formatCardNumber","value","v","matches","match","parts","i","len","push","substring","join","renderPixForm","className","children","toFixed","onChange","e","target","placeholder","onClick","disabled","alt","navigator","clipboard","writeText","renderCardForm","required","maxLength","toUpperCase","Date","now","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d"],"sources":["/Users/joaoherrera/Downloads/safeswap-main 3/frontend/src/pagamento.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\n\n// Configuração do Mercado Pago - PUBLIC KEY CONFIGURADA\nconst MERCADO_PAGO_PUBLIC_KEY = 'TEST-63319c0b-3d7e-4fd4-9a08-b97ef21fc423';\n\nexport default function Pagamento() {\n  const location = useLocation();\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [pixData, setPixData] = useState(null);\n  const [cardFormData, setCardFormData] = useState({\n    cardNumber: '',\n    cardholderName: '',\n    expirationMonth: '',\n    expirationYear: '',\n    securityCode: '',\n    identificationType: 'CPF',\n    identificationNumber: '',\n    email: ''\n  });\n\n  // Pegar dados do state ou da URL como fallback\n  const valor = location.state?.valor || parseFloat(new URLSearchParams(location.search).get('valor') || '0');\n  const metodo = location.state?.metodo || new URLSearchParams(location.search).get('metodo') || 'pix';\n  const festa = location.state?.festa;\n  const quantidades = location.state?.quantidades;\n\n  // Debug para verificar os dados recebidos\n  useEffect(() => {\n    console.log('Dados recebidos no pagamento:', {\n      valor: valor,\n      metodo: metodo,\n      festa: festa,\n      state: location.state\n    });\n  }, [valor, metodo, festa, location.state]);\n\n  useEffect(() => {\n    // Carregar SDK do Mercado Pago\n    const script = document.createElement('script');\n    script.src = 'https://sdk.mercadopago.com/js/v2';\n    script.async = true;\n    document.body.appendChild(script);\n\n    script.onload = () => {\n      // Inicializar Mercado Pago quando o script carregar\n      if (window.MercadoPago) {\n        window.mp = new window.MercadoPago(MERCADO_PAGO_PUBLIC_KEY);\n        console.log('Mercado Pago SDK carregado com sucesso!');\n      }\n    };\n\n    return () => {\n      if (document.body.contains(script)) {\n        document.body.removeChild(script);\n      }\n    };\n  }, []);\n\n  // Função para criar pagamento PIX\n  const createPixPayment = async () => {\n    setLoading(true);\n    setError('');\n\n    try {\n      const response = await fetch('/api/create-pix-payment', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          transaction_amount: valor,\n          description: `Ingresso para ${festa?.nome || 'festa'}`,\n          payment_method_id: 'pix',\n          payer: {\n            email: cardFormData.email || 'cliente@email.com'\n          },\n          metadata: {\n            festa_id: festa?.id,\n            festa_nome: festa?.nome,\n            quantidades: quantidades\n          }\n        })\n      });\n\n      const data = await response.json();\n      \n      if (data.point_of_interaction) {\n        setPixData({\n          qr_code: data.point_of_interaction.transaction_data.qr_code,\n          qr_code_base64: data.point_of_interaction.transaction_data.qr_code_base64,\n          payment_id: data.id\n        });\n\n        // 🆕 SIMULAÇÃO: Após 15 segundos, simular pagamento aprovado (APENAS PARA TESTES)\n        // Em produção, isso será feito via webhook do Mercado Pago\n        setTimeout(() => {\n          console.log('Simulando pagamento PIX aprovado...');\n          navigate('/dados', { \n            state: { \n              paymentId: data.id,\n              status: 'approved',\n              valor: valor,\n              festa: festa\n            } \n          });\n        }, 15000); // 15 segundos para dar tempo de testar\n\n      } else {\n        setError(data.error || 'Erro ao gerar QR Code. Tente novamente.');\n      }\n    } catch (err) {\n      setError('Erro ao gerar pagamento PIX. Verifique se o servidor está rodando.');\n      console.error('Erro:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // 🔧 FUNÇÃO CORRIGIDA: Processar pagamento com cartão\n  const processCardPayment = async () => {\n    setLoading(true);\n    setError('');\n\n    try {\n      // Validar campos antes de enviar\n      if (!validateCardForm()) {\n        setError('Por favor, preencha todos os campos corretamente.');\n        setLoading(false);\n        return;\n      }\n\n      // Criar token do cartão usando SDK do Mercado Pago\n      if (window.mp) {\n        try {\n          // Dados do cartão para criar o token\n          const cardData = {\n            cardNumber: cardFormData.cardNumber.replace(/\\s/g, ''),\n            cardholderName: cardFormData.cardholderName,\n            cardExpirationMonth: String(cardFormData.expirationMonth).padStart(2, '0'),\n            cardExpirationYear: `20${cardFormData.expirationYear}`,\n            securityCode: cardFormData.securityCode,\n            identificationType: cardFormData.identificationType,\n            identificationNumber: cardFormData.identificationNumber.replace(/\\D/g, '')\n          };\n\n          console.log('🔧 Dados do cartão para token:', cardData);\n\n          const token = await window.mp.createCardToken(cardData);\n          \n          console.log('🎯 Token criado:', token);\n\n          if (!token || !token.id) {\n            throw new Error('Falha ao criar token do cartão');\n          }\n\n          // 🔧 CORREÇÃO: Payload limpo para o backend\n          const paymentPayload = {\n            token: token.id,\n            transaction_amount: valor,\n            description: `Ingresso para ${festa?.nome || 'festa'}`,\n            installments: 1,\n            // 🎯 REMOVIDO: payment_method_id fixo - deixa o MP detectar automaticamente\n            // 🎯 REMOVIDO: issuer_id - pode causar conflitos\n            payer: {\n              email: cardFormData.email,\n              identification: {\n                type: cardFormData.identificationType,\n                number: cardFormData.identificationNumber.replace(/\\D/g, '')\n              }\n            },\n            metadata: {\n              festa_id: festa?.id,\n              festa_nome: festa?.nome,\n              quantidades: quantidades\n            }\n          };\n\n          console.log('🚀 Enviando para backend:', paymentPayload);\n\n          // Enviar token para o backend\n          const response = await fetch('/api/process-card-payment', {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n            body: JSON.stringify(paymentPayload)\n          });\n\n          const data = await response.json();\n          \n          console.log('🎯 Resposta do backend:', data);\n          \n          if (data.status === 'approved') {\n            console.log('✅ Pagamento aprovado! Método detectado:', data.payment_method_id);\n            \n            // Redirecionar para /dados\n            navigate('/dados', { \n              state: { \n                paymentId: data.id,\n                status: data.status,\n                valor: valor,\n                festa: festa,\n                paymentMethod: data.payment_method_id // Incluir método detectado\n              } \n            });\n          } else {\n            setError(`Pagamento ${data.status}. ${data.message || data.status_detail || 'Tente novamente.'}`);\n          }\n        } catch (tokenError) {\n          console.error('❌ Erro ao criar token:', tokenError);\n          setError('Erro ao processar dados do cartão. Verifique as informações.');\n        }\n      } else {\n        // Fallback se o SDK não carregar\n        console.error('❌ SDK do Mercado Pago não carregado');\n        setError('Erro ao carregar sistema de pagamento. Recarregue a página.');\n      }\n    } catch (err) {\n      setError('Erro ao processar pagamento. Verifique se o servidor está rodando.');\n      console.error('❌ Erro:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Validar formulário do cartão\n  const validateCardForm = () => {\n    return (\n      cardFormData.email &&\n      cardFormData.cardNumber.length >= 16 &&\n      cardFormData.cardholderName &&\n      cardFormData.expirationMonth &&\n      cardFormData.expirationYear &&\n      cardFormData.securityCode.length >= 3 &&\n      cardFormData.identificationNumber.length >= 11\n    );\n  };\n\n  // Formatar número do cartão\n  const formatCardNumber = (value) => {\n    const v = value.replace(/\\s+/g, '').replace(/[^0-9]/gi, '');\n    const matches = v.match(/\\d{4,16}/g);\n    const match = (matches && matches[0]) || '';\n    const parts = [];\n\n    for (let i = 0, len = match.length; i < len; i += 4) {\n      parts.push(match.substring(i, i + 4));\n    }\n\n    if (parts.length) {\n      return parts.join(' ');\n    } else {\n      return value;\n    }\n  };\n\n  // Renderizar formulário de PIX\n  const renderPixForm = () => (\n    <div className=\"space-y-6\">\n      {!pixData ? (\n        <>\n          <div className=\"text-center\">\n            <div className=\"w-20 h-20 bg-teal-500/20 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <span className=\"text-4xl\">📱</span>\n            </div>\n            <h3 className=\"text-xl font-semibold mb-2\">Pagamento via PIX</h3>\n            <p className=\"text-gray-400\">Rápido, seguro e sem taxas adicionais</p>\n          </div>\n\n          <div className=\"bg-gray-700/50 rounded-lg p-4\">\n            <p className=\"text-sm text-gray-300 mb-2\">Valor a pagar:</p>\n            <p className=\"text-2xl font-bold text-teal-400\">R$ {valor.toFixed(2)}</p>\n          </div>\n\n          {/* Email para PIX */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-300 mb-2\">\n              E-mail (para receber o comprovante)\n            </label>\n            <input\n              type=\"email\"\n              value={cardFormData.email}\n              onChange={(e) => setCardFormData({...cardFormData, email: e.target.value})}\n              className=\"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\"\n              placeholder=\"seu@email.com\"\n            />\n          </div>\n\n          <button\n            onClick={createPixPayment}\n            disabled={loading || valor === 0}\n            className=\"w-full py-4 bg-teal-500 text-white font-medium rounded-lg transition-all hover:bg-teal-400 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {loading ? 'Gerando PIX...' : 'Gerar código PIX'}\n          </button>\n        </>\n      ) : (\n        <div className=\"space-y-6\">\n          <div className=\"text-center\">\n            <h3 className=\"text-xl font-semibold mb-2\">PIX Gerado!</h3>\n            <p className=\"text-gray-400\">Escaneie o QR Code ou copie o código</p>\n          </div>\n\n          {/* QR Code */}\n          {pixData.qr_code_base64 && (\n            <div className=\"bg-white p-4 rounded-lg mx-auto w-fit\">\n              <img \n                src={`data:image/png;base64,${pixData.qr_code_base64}`} \n                alt=\"QR Code PIX\" \n                className=\"w-64 h-64\"\n              />\n            </div>\n          )}\n\n          {/* Código PIX Copia e Cola */}\n          <div className=\"space-y-2\">\n            <label className=\"text-sm text-gray-400\">PIX Copia e Cola:</label>\n            <div className=\"bg-gray-700/50 rounded-lg p-4 break-all\">\n              <p className=\"text-xs font-mono text-gray-300\">{pixData.qr_code}</p>\n            </div>\n            <button\n              onClick={() => navigator.clipboard.writeText(pixData.qr_code)}\n              className=\"w-full py-3 bg-gray-700 text-white font-medium rounded-lg transition-all hover:bg-gray-600\"\n            >\n              Copiar código PIX\n            </button>\n          </div>\n\n          {/* 🆕 NOVO: Botão para simular pagamento aprovado (APENAS PARA TESTES) */}\n          <div className=\"border-t border-gray-600 pt-4\">\n            <p className=\"text-xs text-gray-400 text-center mb-3\">⚠️ Modo de teste:</p>\n            <button\n              onClick={() => navigate('/dados', { \n                state: { \n                  paymentId: pixData.payment_id,\n                  status: 'approved',\n                  valor: valor,\n                  festa: festa\n                } \n              })}\n              className=\"w-full py-3 bg-green-600 text-white font-medium rounded-lg transition-all hover:bg-green-500\"\n            >\n              🧪 Simular Pagamento Aprovado\n            </button>\n          </div>\n\n          <div className=\"text-center text-sm text-gray-400\">\n            <p>Após o pagamento, você será redirecionado automaticamente</p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n\n  // Renderizar formulário de cartão\n  const renderCardForm = () => (\n    <div className=\"space-y-6\">\n      <div className=\"text-center\">\n        <div className=\"w-20 h-20 bg-teal-500/20 rounded-full flex items-center justify-center mx-auto mb-4\">\n          <span className=\"text-4xl\">💳</span>\n        </div>\n        <h3 className=\"text-xl font-semibold mb-2\">Pagamento com Cartão</h3>\n        <p className=\"text-gray-400\">Crédito ou débito • Aceita Visa, Master, Amex</p>\n      </div>\n\n      <div className=\"bg-gray-700/50 rounded-lg p-4\">\n        <p className=\"text-sm text-gray-300 mb-2\">Valor a pagar:</p>\n        <p className=\"text-2xl font-bold text-teal-400\">R$ {valor.toFixed(2)}</p>\n      </div>\n\n      <div className=\"space-y-4\">\n        {/* Email */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-300 mb-2\">\n            E-mail\n          </label>\n          <input\n            type=\"email\"\n            required\n            value={cardFormData.email}\n            onChange={(e) => setCardFormData({...cardFormData, email: e.target.value})}\n            className=\"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\"\n            placeholder=\"seu@email.com\"\n          />\n        </div>\n\n        {/* Número do Cartão */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-300 mb-2\">\n            Número do Cartão\n          </label>\n          <input\n            type=\"text\"\n            required\n            maxLength=\"19\"\n            value={cardFormData.cardNumber}\n            onChange={(e) => setCardFormData({\n              ...cardFormData, \n              cardNumber: formatCardNumber(e.target.value)\n            })}\n            className=\"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\"\n            placeholder=\"0000 0000 0000 0000\"\n          />\n          <p className=\"text-xs text-gray-400 mt-1\">Aceita Visa, Mastercard, American Express</p>\n        </div>\n\n        {/* Nome no Cartão */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-300 mb-2\">\n            Nome no Cartão\n          </label>\n          <input\n            type=\"text\"\n            required\n            value={cardFormData.cardholderName}\n            onChange={(e) => setCardFormData({\n              ...cardFormData, \n              cardholderName: e.target.value.toUpperCase()\n            })}\n            className=\"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\"\n            placeholder=\"NOME COMPLETO\"\n          />\n        </div>\n\n        {/* Validade e CVV */}\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-300 mb-2\">\n              Validade\n            </label>\n            <div className=\"grid grid-cols-2 gap-2\">\n              <input\n                type=\"text\"\n                required\n                maxLength=\"2\"\n                value={cardFormData.expirationMonth}\n                onChange={(e) => setCardFormData({\n                  ...cardFormData, \n                  expirationMonth: e.target.value.replace(/\\D/g, '')\n                })}\n                className=\"px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\"\n                placeholder=\"MM\"\n              />\n              <input\n                type=\"text\"\n                required\n                maxLength=\"2\"\n                value={cardFormData.expirationYear}\n                onChange={(e) => setCardFormData({\n                  ...cardFormData, \n                  expirationYear: e.target.value.replace(/\\D/g, '')\n                })}\n                className=\"px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\"\n                placeholder=\"AA\"\n              />\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-300 mb-2\">\n              CVV\n            </label>\n            <input\n              type=\"text\"\n              required\n              maxLength=\"4\"\n              value={cardFormData.securityCode}\n              onChange={(e) => setCardFormData({\n                ...cardFormData, \n                securityCode: e.target.value.replace(/\\D/g, '')\n              })}\n              className=\"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\"\n              placeholder=\"123\"\n            />\n          </div>\n        </div>\n\n        {/* CPF */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-300 mb-2\">\n            CPF do Titular\n          </label>\n          <input\n            type=\"text\"\n            required\n            maxLength=\"14\"\n            value={cardFormData.identificationNumber}\n            onChange={(e) => {\n              let value = e.target.value.replace(/\\D/g, '');\n              if (value.length <= 11) {\n                value = value.replace(/(\\d{3})(\\d{3})(\\d{3})(\\d{2})/, '$1.$2.$3-$4');\n              }\n              setCardFormData({...cardFormData, identificationNumber: value});\n            }}\n            className=\"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-white\"\n            placeholder=\"000.000.000-00\"\n          />\n        </div>\n      </div>\n\n      {error && (\n        <div className=\"bg-red-500/20 border border-red-500/50 rounded-lg p-4\">\n          <p className=\"text-red-400 text-sm\">{error}</p>\n        </div>\n      )}\n\n      <button\n        onClick={processCardPayment}\n        disabled={loading || valor === 0}\n        className=\"w-full py-4 bg-teal-500 text-white font-medium rounded-lg transition-all hover:bg-teal-400 disabled:opacity-50 disabled:cursor-not-allowed\"\n      >\n        {loading ? 'Processando...' : 'Finalizar Pagamento'}\n      </button>\n\n      {/* 🆕 NOVO: Botão para simular pagamento aprovado (APENAS PARA TESTES) */}\n      <div className=\"border-t border-gray-600 pt-4\">\n        <p className=\"text-xs text-gray-400 text-center mb-3\">⚠️ Modo de teste:</p>\n        <button\n          onClick={() => navigate('/dados', { \n            state: { \n              paymentId: 'MP-TEST-' + Date.now(),\n              status: 'approved',\n              valor: valor,\n              festa: festa\n            } \n          })}\n          className=\"w-full py-3 bg-green-600 text-white font-medium rounded-lg transition-all hover:bg-green-500\"\n        >\n          🧪 Simular Pagamento Aprovado\n        </button>\n      </div>\n    </div>\n  );\n\n  // Se o valor for 0, mostrar erro\n  if (valor === 0) {\n    return (\n      <div className=\"min-h-screen bg-gray-900 text-white p-4 md:p-6\">\n        <div className=\"max-w-md mx-auto\">\n          <div className=\"bg-gray-800 rounded-xl shadow-lg border border-gray-700 p-6\">\n            <h2 className=\"text-xl font-bold text-red-400 mb-4\">Erro no pagamento</h2>\n            <p className=\"text-gray-300 mb-6\">Nenhum valor foi informado para o pagamento.</p>\n            <button \n              onClick={() => navigate(-1)} \n              className=\"w-full py-3 bg-teal-500 text-white font-medium rounded-lg transition-all hover:bg-teal-400\"\n            >\n              Voltar ao checkout\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-900 text-white p-4 md:p-6\">\n      <div className=\"max-w-md mx-auto\">\n        <div className=\"flex items-center justify-between mb-8\">\n          <button \n            onClick={() => navigate(-1)} \n            className=\"text-gray-400 hover:text-white transition-colors flex items-center group\"\n          >\n            <svg className=\"w-5 h-5 mr-2 transform group-hover:-translate-x-1 transition-transform\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"></path>\n            </svg>\n            <span>Voltar</span>\n          </button>\n          <span className=\"text-xs bg-teal-500 text-white px-3 py-1 rounded-full\">Pagamento Seguro</span>\n        </div>\n\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold mb-1\">Pagamento</h1>\n          <p className=\"text-gray-400\">Complete sua compra de forma segura</p>\n        </div>\n\n        <div className=\"bg-gray-800 rounded-xl shadow-lg border border-gray-700 overflow-hidden\">\n          <div className=\"p-6\">\n            {metodo === 'pix' ? renderPixForm() : renderCardForm()}\n          </div>\n        </div>\n\n        <div className=\"mt-6 flex items-center justify-center space-x-4 text-xs text-gray-500\">\n          <span>Pagamento processado por</span>\n          <img \n            src=\"https://http2.mlstatic.com/frontend-assets/mp-web-navigation/ui-navigation/5.21.22/mercadopago/logo__large@2x.png\" \n            alt=\"Mercado Pago\" \n            className=\"h-6 filter brightness-75\"\n          />\n        </div>\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}